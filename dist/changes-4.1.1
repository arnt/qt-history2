Qt 4.1.1 is a bug-fix release. It maintains both forward and backward
compatibility (source and binary) with Qt 4.1.0.

The Qt version 4.1 series is binary compatible with the 4.0.x series.
Applications compiled for 4.0 will continue to run with 4.1.

****************************************************************************
*                           General                                        *
****************************************************************************

moc
        Better handling of preprocessor statements in combination
        with multi line comments.
	Fixed problem where moc would generate meta information for invalid 
	signals/slots. (task 95487)


configure
        Respect the -no-sql-mysql flag.

compilers
        Fix build of dumpcpp-dependent projects in Visual Studio 6.

        Fixed compilation for solaris-cc-64.

qt3to4
	Fixed the issue where 'int red' would be translated to 'Qt::red'.
	Improved handling of macros created by moc.

Qt Designer
        Numerous fixes and improvements.
        ion of invalid font tags ### ???
        uic: Fixed bug that caused retranslateUI() to add existing
        items in combobox once again
	fixed dependency problem where qtDesigner modules would depend on 
	a private class.
	Added missing generation of setColumnCount() and setRowCount() for 
	QTableWidget. (task 97900)
	Fixed a platform incompatiblity when saving icon properties on Windows.
	(task 93316)
	Fixed a crash when breaking the layout in a dock widget. (task 97642)
	Fixed a crash when opening a new .ui file while in "Edit Tab Order" mode.
	Fixed a crash when adding a widget to a QDockWidget.
	Improved preview of signal/slot connections. (task 95834)
	Fixed an issue where moving widgets in a form could make signal/slot
	connections and tab order to get lost.
	Fixed a corruption of the shortcut properties in .ui files when saving
	under some locales. (task 97316)
	Fixed preview of QComboBox with item icons.
	Fixed an issue preventing cancellation of 'New resource file' if 
	previous resource file was deleted. (task 89453)
	Fixed use of F1 as help shortcut. (task 99897)

Qt Assistant 
	Fixed problem with restoring window geometry on multi screen 
	configurations. (task 90349)

Qt Linguist / Internationalization
        Fixed tr() idioms, so that translation actually works.
	Fixed encoding of translated text. (task 92184)

Qt Translation
	Added translation files for Simplified Chinese.
	Fixed a problem with lupdate parsing output from uic.

****************************************************************************
*                          Library                                         *
****************************************************************************

...

General improvements
--------------------

- QAbstractSlider
	Ensure changed-signals are only emitted when the value actually changed. 
	(task 98493)

- QAbstractSocket
	Fixed a crash if disconnected during waitForReadyRead(). (task 99863)

- QAccessibleWidget 
	Fix an off-by-one navigation error in the accessibility support 
	for menubar and menus. (task 90385)

- QByteArray
	Fixed leftJustified() and rightJustified() when array contains \0's.
	(task 94728)

- QComboBox
	Fixed a crash when setting and deleting the model.
	Fixed a crash when using a QListWidget as the view.

- QCoreApplication
	Fixes racecondition during plugin loading.

- QCommonStyle
	Fixed wrong size hint of PM_MenuButtonIndicator.

- QVariant
        The QVariant(const char *) constructor is now unavailable when
        QT_NO_CAST_TO_ASCII is set. Otherwise, it uses QString::fromAscii
        to convert the const char * to a unicode QString to prevent
        loss of information.

- QXmlSimpleReader
        A significant (approx. 50x) speedup in QXmlSimpleReader when
        parsing documents which contain internal or external entities.

- QDateTime
	Fixed a regression in fromString. (task 98678)
	Avoid potential hang when paring invalid date formats.

- QFile
        Changed behavior or rename() and copy()...

- QFileDialog
        Make sure filter combobox gets enabled when changing from 
        Directory to ExistingFile mode.
        Improve filename completion for files with the same name but 
        different extension.
        Make sure the selection is updated when modifying the filename 
        by removing characters.
        Allow typing in several file names in the file name line edit.
        Improve handling of non-existent windows shares.
        Improve handling of hidden directories.
        Make it possible to create new folder when a folder called 
        "New Folder" already exists.
	Improve usability by not changing the filename text when directories 
	are selected. 
	Improve usability by not autoselecting the first item when changing 
	directories.
	Ensure that calling setDirectory with a path shows the directory when 
	the path contains a file name.
	Avoid unnecessary resolving of mount points, leading to lockups
	on Unix.
	Fixed potential crash when selecting an extention filter with no 
	matches in current directory. (task 97304)
	Fixed a problem where using selectFilter() didn't update the view. 
	(task 85614)

- QFileInfo
	Fixed issue where copying a QFileInfo and calling refresh() could result 
	in file info data being cleared. (task 94720)
	Fixed issue where calling readLink() would resolve link targets 
	incorrectly. (task 90607)

- QGLWidget
	Switching from fullscreen mode to normal mode no longer results in 
	incorrect window decorations.
	Fixed overline, underline and strikethrough for text drawn with 
	renderText(). (task 94249)

- QList
	Fixed a memory leak when repeatedly removing items from the end and
	inserting items in the middle.

- QPdfPrintEngine
        Made our generated PDFs readable by Ghostscript.
        Support pens that have patterns/pixmaps.
	Support landscape mode. (task 99066)

- QTextDocument
        Support span style background-color.
        Fix nested tables in html documents regression.

- QTextLayout
	Added support for soft-hyphens.
        
- QToolButton
        Make popup menus appear on the correct screen.
	Fixed ToolButtonPopupMode when QToolButton has a QAction. (task 99484)

- QToolBar
        Combo boxes now appears as submenus in a toolbar extension.
        setIconSize() now works correctly.
	Relative position within toolbars are now kept when saving and restoring state.

- QIcon
	Fixed issue where creating QIcons with an invalid path could 
	result in a crash. (task 95955)

- Improved handling of focus events when using input methods.

- QInputDialog
	Fixes ampersands shown instead of underline in labels.

- QPaintEngine
	Fixed an out of memory issue when drawing very long lines. (task 97448)
        OpenGL : Make sure the image and pixmap cache is used.
        OpenGL : Faster rect outlining for the most common case.

- QSyntaxHighlighter
	Fixed missing handling of blocks of text under certain conditions.
	Improved interaction with input methods. (task 97823)

- QTextBrowser
	Fix missing linebreak after paragraph.
        
- QTextEdit
        Improve handling of the TITLE tag.
        Fixed navigating links via tab.
        Improved handling of malformed html.
        Fixed rendering for tables with thead/tbody/tfoot elements.
	Improved copy and paste of content with whitespace
	Make undo/redo update the cursor position.
	Fixed lost cursorPositionChanged() signal in read-only mode.
	Fixed memory leak when calling setHtml() repeatedly.
	Significantly improved performance when appending and editing text.
	Improved performance when selecting all text.
	Emit copyAvailable() on mouse selection. (task 98453)

- QSizeGrip
	Fixed size grip painting when maximizing a QMainWindow in a 
	QWorkspace. (task 99887)

- QSvg
        Improve stroking with pen width 0.
        Fix rectangle filling bug.

- QDockWidget
        Update toggleViewAction() when widget gets hidden with close
        button.

- QMainWindow
        Handle RTL layout for dockwidgets properly.
        Make dockwidgets remember their sizes after being hidden.
	Improved reliability when saving and restoring state.

- Q3DataTable
	Drivers not supporting the QuerySize feature would display one
	row of data too little. (task 91136)

- Q3IconView
	Fixed selection appearance. (task 80057)

- Q3TextEdit
        Fixed focus indicator tabbing through tables.
	Fixed coloring when inserting text after use of setColor(). 
	(task 88879)

- Q3TabDialog
	Added missing selected() signal

- Q3ListView
	Fixed occasional crashes when deleting items. (task 98239)
	Fixed wrong label after addLabel(QString()). (task 95640)

- Q3ScrollView
	Fixed default focus policy for deriving classes. (task 94578)

- Q3ToolBar
        Q3Action::setOn() now works correctly.
	Adding an action now sets all action properties correctly.

- Q3ActionGroup
        Fix drop down drawing error.

- Q3MainWindow
	Fixed a regression in setUsesIconText().


- QXpmHandler
        Fixed handling of non-transparent XPM images.

- QImage
	Changed behaviour of the equality operator. ### WAS? espen: revert this change? 
	Fixed drawing of QBitmap's onto a QImage.

- QImageIOHandler
        Made all suppported image formats support the Size option.

- QDialog
	Fixed an issue where setExtension()/showExtension() didn't work in
	a constrained size mode. (task 99446)

- QDir
        cd() now fails when attempting to cd to a non-directory.

- QAbstractItemView
        Fix selections when mouse-tracking is turned on.
	Fixed selection issues after row resizing. (task 92336)
	Fixed focus after pressing enter. (task 96993)

- QAbstractItemModel
        More consistent behaviour in drag-and-drop code.	

- QItemSelectionModel
	Fixed an infinite loop in isRowSelected. (task 95832)

- QListView
	Fixed an assert when using QProxyModel as the model. (task 100139)

- QTableView
        Fixed drawing of selections after moving columns.
        Do not wrap to the top if Page Down is pressed.
        Improve scrolling behavior.
        QTableView now takes ownership of QHeaders set using setHorizontalHeader()
	Fixed issue where calling setModel(0) could result in a crash. (task 97535)
	
- QTreeView
        Fixed scrolling-related item expand bug.
        Improve scrolling behavior.
        QTreeView now takes ownership of QHeaders set using setHorizontalHeader()
        Avoid crash when calling setRowHidden with no model.
	Avoid crash when calling sizeHintForColumn() in some cases.
	Improved performance when adding rows.
	Fixed a bug where changing row heights sometimes did not update
	the view properly. (task 94567)
	Fixed a bug where calling setCurrentIndex() did update the view, but 
	not currentIndex(). (task 92311)
	Removed extra emit of the expanded() signal on already expanded 
	brances. (task 90453)

- QTreeWidget
	Fixed tristate check item behavior. (task 87076)

- QItemDelegate
        Better handling of QStyleOptionViewItem::Bottom.
        Increased the delegate horizontal margin.
        
- QHeaderView
        Respects dragDistance.
        Fixed painting problems caused by clicking both mouse buttons
        at the same time.
        Respects TextColorRole.
        Fixed painting flaws when using sort indicators. 
	Fixed issue where QStyleOptionHeader::End would not be set by
	paintSection. (task 89576)
	Only the left mouse button can now be used to move and resize
	header sections. (task 98243)
	Fixed incorrect header size after swapping header sections. 
	(task 96860)
	Fixed resize mode of header sections after section moves. (task 87754)
	Fixed an assert when changing the selection model. (task 97080)

- QGridLayout 
        Respect specified alignment over default alignment.

- QSvgRenderer
        Better handling  of invalid files.

- QMenu
	Fixed shortcut handling of already selected submenus. (task 81011)

- QMenuBar
	Improved widget placement in setCornerWidget(). (task 95496)

- QMenuItem
	Ensure space for both check mark and icon when using QPlastiqueStyle.

- QPrintEngine
        Better font underlining/overlining.? (199807)
        Embed fonts as TrueType font files into PDF? (199815)
		
- QWidget
        Fix regression in setMask().
	stuff ### fixme (change 204854)
	Fixed issue where incorrect minimum size was reported after reparenting from
	a top level widget.
	Fixed return value of normalGeometry() after the widget has been maximized.
	(task 98499)
	Fixed an occational crash on application exit if the widget was 
	created before the widget mapper is initialized. (task 89253)

- QHash / QSet
        Make the operator==() not take the internal order of elements
        into account when comparing.

- QUrl
	Improve handling of hostnames containing digits.
        Fix crash when calling hasQueryItem() on QUrl without any
        query items.
	Added support for parsing file names with '[' and ']' characters. (task 95629)

- QLayout
        Warn instead of crash when adding two layouts to a widget.

- QLocale
	Add missing entry for "nb".

- QPixmap
	Fixed issue where save() in some cases would return true on failure.

- QProgressBar
        Fix incorrect progress in some cases.         

- QTabWidget
        Fixed bug that caused missing resize when dynamically adding widgets.
	Fixed text positioning in a tab with an icon. (task 93925)

- QMenu
        Fix setting the window title on torn off menus.
        Fix bug where exec() returned the wrong QAction on some cases.
        
- QTemporaryFile
	Fixed issue where calling open() could potentially change the file name.
	(task 96965)

- QScrollArea
	Fixed an issue where the scroll area sometimes would not resize to
	compensate for content change. (task 86278)

- QString
	Fixed regression in fromLocal8Bit().

- QRadioButton
	Fixed a potential crash in QRadioButton Qt 3 support constructors. (task 97955)

- QTextDocument
        Improved stability when importing incorrectly formed html tables.
	Improved stability when importing closing tags without corresponding 
	opening tags.
        
- QTextStream
	Ensure valid codec converter state after calling seek(0).	
	Fixed issue where readAll() would not work with sequential devices.
	(task 97917)	

- QPushButton
        Buttons reparented into a dialog parent through the layout are now auto-default.

- QDirModel
	Improved stability when appending network drives.
	Improved stability when handling symlinks with relative paths.

- QSortFilterProxyModel
	Improve stability when adding rows to source model.
	Fixed issue where some nodes would show up as expandable even if all 
	it's children had been filtered. (task 97659)
	Fixed a crash when deleting rows. (task 99904)

- QTabBar
        Improve handling of tab removal.

- PDF
        Support PDF font embedding, resulting in smaller PDF files and 
        selectable text.

- QMYSQLDriver 
        Fix crash when formatValue() is called without connection.

- QVariant
        Improve operator==() behavior when comparing different types.

- QMessageBox
        information() now works correctly when calling it after returning
        from QApplication::exec()
        
- XMLInputReader
	Fixed issue where entities in XML files were not resolved. (task 95004)


Platform-Specific changes
-------------------------

Windows:


- Timers now continue to fire when windows enters a modal event loop.
- Improve Type 1 font rendering.
- Improved performance of font rendering.
- Use the standard fallback fonts for asian languages. (task 93295)
- Improved checkbox coloring within selections in a QTableView.

- OpenGL
	Added workaround for missing OpenGL sample buffers on the Mobile 
	Intel 915GM Express Chipset.
	Fixed rendering into a QPixmap.

- QAxServer
	Fixed issue where updateRegistry would report success, even though 
	the operation failed. (task 98380)
	Fixed comparison of class attributes. (task 99093)

- QAxWidget
	Support parameters of type short* and char* in signal/slots. 
	(task 99703)

- QClipboard
        Make sure the dataChanged() signal is emitted correctly.

- QColordialog
	Fixed various selection issues in WindowsXP style. (task 89556)

- QUdpSocket
        Better handling when sending to an unbound port.

- QHeaderView
	Improved header highlighting in WindowsXP style. (task 91852)

- QInputDialog
	Calling setText() also selects all text to be consistent with 
	other platforms.

- QPrinter
	Fixed issue where the orientation for a QPrinter would be 
	ignored. (task 97315)

- QPrintDialog
	Fix unhandled exception when a print dialog is launched from within 
	Visual Studio.

- QPrintEngine
	Ensure correct pageRect() and paperRect() when printer resolution is set 
	manually. 

- QFileDialog
        Improve handling of path names with special characters.
        Maintain modality chain when showing a native modal inside a
        qt modal.
        Speedup when browsing dirs containing broken shortcuts.

- QWindowsXPStyle
	Fixed QApplication::setStyle() if called before construction of the
	application object. (task 89558)

- QWorkSpace
        Improve window resizing.
        Improve title bar and button apperance in XP style. 
	Improved focus handling.	
	Fixed update of child masks on style change.
	Fixed restore action not being enabled on maximize and minimze. 
	(task 81241)
	Fixed a potential crash in maximizeWindow(). (task 97264)

- QDockWidget
        Improve the look of title bar buttons.
        Improved appearance of dock widget title and frame.

- QWdiget
        Fix setWindowOpacity flicker.

- QLabel
	Improved appearance when disabled.

- QLineEdit
        Make QLineEdit respect the XP color scheme.         
        
- Printing        
        Fix PCL printer line drawing bug.

X11:

- Reintroduced qt_x11_set_global_double_buffer() for binary compatibility.

- Improved tablet event handling.

- The KeypadModifier is now set when NumLock is enabled. (task 97522)

- QBitmap
	Fixed wrong text drawing under some fontconfig settings. (task 77461)

- QtDemo now asks if animations should be disabled if it is not running on 
	an accelerated XRender.

- QLibrary
	isLibrary now returns true for .a and .so on AIX.

- QPaintEngine
	Fixed issue where filling and stroking ellipses could leave pixel 
	gaps.	

- QPainter
        Implemented Porter-Duff composition support.
        Fix artifacts when drawing aliased primitives with an alpha pen.
        Fixed issue where rotating pixmaps could add a pixel row in some cases. 
	(task 92307)
	Fixed drawing of arcs of less than 1 degree. (task 92639)
	Made drawText() honor the Qt::TextWrapAnywhere flag.

- QPrinter
	Fixed issue where some child processes were not cleaned up after use. 
	(task 98217)

- QPrintDialog
	Fixed problems when using "From page" and "To page" spin boxes. 
	(task 92274)
	It is no longer possible to press "ok" when no printers are configured.	
- QScrollArea
	Catch double click also when size exceeds window system size limits.
	(task 98816)

- qmake
	Improved stability when modifying environment variables
	Allow '/' as a path separator on all platforms.

- QProcess
	Fixed possible deadlock when calling startDetatched(). 
	(task 90183)

- QTextEdit
	Fixed an issue where the horizontal scrollbar did not show up. 
	(task 92670)

- QWorkspace
	Fixed missing mouse event propagation to child widgets. (task 100149)

Mac OS X:

- General fixes to the drag and drop support.
- Fixed compilation with -no-qt3support on Mac OS 10.3
- Ensure that the mac installer can accept an academic license.
- qmake now places PkgInfo in the "Contents" directory of the .app bundle.
- Improved performance when resizing widgets.
- Fixed font issues for input methods with japanese. (task 96874)
- Fixed issue with pasting japanese text. (task 97391)
- Correctly set architecture and SDKROOT when creating a Xcode project. (task 95717)
- Fixed truncated PDF generation of large documents. (task 93596)

- Q3TextEdit
	Fixed a crash in paragraphRect() when all content had been deleted.
	(task 96658)

- Q3ListViewItem
	Fixed a infinte loop when editing an item. (task 100034)

- QCursor
        Fix alpha pixmap cursors.

- QHeaderView
        Fix text truncating issue on headers.

- QMenu
	Improved menu styling. (task 86762)	
	Improved popup appearance. (task 96783)

- QWorkSpace 
        Improve workspace children appearance.

- QDesktopWidget
	Improve stability when changing users.
        
- QDockWidget 
        Improve dock widget appearance.

- QGroupBox
	More conformant styling.

- QTextEdit
	Fixed focus issues with japanese input. (task 97171)
	Fixed issue with pasting unicode text between applications. (task 96649)

- QToolBar 
        Improve tool bar appearance.

- QPushButton
        Make mac style obey the icon size set by setIconSize().
	Make sure buttons are not shown as default on inactive windows.

- QSplashScreen
        Fix painting errors when using showMessage().
        
- QPainter
	Add support SmoothPixmap transform

- QLabel
	Fix labels painted incorrectly when using MacMetalStyle.

- QTextFormat
	Fixed a crash when setting a font's pixel size to -1. (task 100222)

Qtopia Core

- Removed flickering when mouse cursor is above an animation.
- Optimized use of shared memory.
- Optionally use iwmmxt intrinsics to optimize painting.
- Implement QPixmap::grabWindow
- Added a simple example on how to calibrate touch screen mouse handlers.

- Fonts
	Handle BDF fonts without the PIXEL_SIZE property.
	Added Chinese and Japanese fonts.

- PDF
        Support PDF font embedding.
- qvfb
	Fixed a crash when increasing the display size in the configuration dialog.  

3rd-party libraries
-------------------
- Fix memory leak in freetype.

last change was: 206987
