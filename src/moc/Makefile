#############################################################################
# Qt Makefile for the Meta Object Compiler (moc)
#
# The files mocgen.cpp and lex.yy.c are generated by yacc and lex.
#
# You'll need the Win32 GNU package in order to compile the moc from scratch.
# Get it from ftp://ftp.cygnus.com/pub/gnu-win32/win32
#############################################################################

####### Compiler, tools and options

CC	=	cl
CFLAGS	=	-nologo -O2 -DQT_NODLL
INCPATH	=	-I"." -I"..\..\include"
LINK	=	link
LFLAGS	=	/NOLOGO /SUBSYSTEM:console
LIBS	=	
MOC	=	moc

####### Files

HEADERS =	
SOURCES =	mocgen.cpp \
		..\tools\qbuffer.cpp \
		..\tools\qcollection.cpp \
		..\tools\qdatetime.cpp \
		..\tools\qdatastream.cpp \
		..\tools\qgarray.cpp \
		..\tools\qgdict.cpp \
		..\tools\qglist.cpp \
		..\tools\qglobal.cpp \
		..\tools\qgvector.cpp \
		..\tools\qiodevice.cpp \
		..\tools\qstring.cpp
OBJECTS =	mocgen.obj \
		qbuffer.obj \
		qcollection.obj \
		qdatetime.obj \
		qdatastream.obj \
		qgarray.obj \
		qgdict.obj \
		qglist.obj \
		qglobal.obj \
		qgvector.obj \
		qiodevice.obj \
		qstring.obj
SRCMOC	=	
OBJMOC	=	
TARGET	=	moc.exe

####### Implicit rules

.SUFFIXES: .cpp .cxx .cc .c

.cpp.obj:
	$(CC) -c $(CFLAGS) $(INCPATH) -Fo$@ $<

.cxx.obj:
	$(CC) -c $(CFLAGS) $(INCPATH) -Fo$@ $<

.cc.obj:
	$(CC) -c $(CFLAGS) $(INCPATH) -Fo$@ $<

.c.obj:
	$(CC) -c $(CFLAGS) $(INCPATH) -Fo$@ $<

####### Build rules

all: $(TARGET) 

$(TARGET): $(OBJECTS) $(OBJMOC)
	$(LINK) $(LFLAGS) /OUT:$(TARGET) @<<
	    $(OBJECTS) $(OBJMOC) $(LIBS)
<<

moc: $(SRCMOC)

tmake: moc.mak

moc.mak: moc.pro
	tmake moc.pro -o moc.mak

clean:
	-del mocgen.obj
	-del qbuffer.obj
	-del qcollection.obj
	-del qdatetime.obj
	-del qdatastream.obj
	-del qgarray.obj
	-del qgdict.obj
	-del qglist.obj
	-del qglobal.obj
	-del qgvector.obj
	-del qiodevice.obj
	-del qstring.obj
	-del $(TARGET)

####### Compile

mocgen.obj: mocgen.cpp \
		..\..\include\qlist.h \
		..\..\include\qglist.h \
		..\..\include\qcollection.h \
		..\..\include\qglobal.h \
		..\..\include\qgeneric.h \
		..\..\include\qstring.h \
		..\..\include\qarray.h \
		..\..\include\qgarray.h \
		..\..\include\qshared.h \
		..\..\include\qdatetime.h \
		lex.yy.c
	$(CC) -c $(CFLAGS) $(INCPATH) -Fomocgen.obj mocgen.cpp

qbuffer.obj: ..\tools\qbuffer.cpp \
		..\..\include\qbuffer.h \
		..\..\include\qiodevice.h \
		..\..\include\qglobal.h \
		..\..\include\qstring.h \
		..\..\include\qarray.h \
		..\..\include\qgarray.h \
		..\..\include\qshared.h \
		..\..\include\qgeneric.h
	$(CC) -c $(CFLAGS) $(INCPATH) -Foqbuffer.obj ..\tools\qbuffer.cpp

qcollection.obj: ..\tools\qcollection.cpp \
		..\..\include\qcollection.h \
		..\..\include\qglobal.h
	$(CC) -c $(CFLAGS) $(INCPATH) -Foqcollection.obj ..\tools\qcollection.cpp

qdatetime.obj: ..\tools\qdatetime.cpp \
		..\..\include\qdatetime.h \
		..\..\include\qstring.h \
		..\..\include\qarray.h \
		..\..\include\qgarray.h \
		..\..\include\qshared.h \
		..\..\include\qglobal.h \
		..\..\include\qgeneric.h \
		..\..\include\qdatastream.h \
		..\..\include\qiodevice.h
	$(CC) -c $(CFLAGS) $(INCPATH) -Foqdatetime.obj ..\tools\qdatetime.cpp

qdatastream.obj: ..\tools\qdatastream.cpp \
		..\..\include\qdatastream.h \
		..\..\include\qiodevice.h \
		..\..\include\qglobal.h \
		..\..\include\qstring.h \
		..\..\include\qarray.h \
		..\..\include\qgarray.h \
		..\..\include\qshared.h \
		..\..\include\qgeneric.h \
		..\..\include\qbuffer.h
	$(CC) -c $(CFLAGS) $(INCPATH) -Foqdatastream.obj ..\tools\qdatastream.cpp

qgarray.obj: ..\tools\qgarray.cpp \
		..\..\include\qgarray.h \
		..\..\include\qshared.h \
		..\..\include\qglobal.h \
		..\..\include\qstring.h \
		..\..\include\qarray.h \
		..\..\include\qgeneric.h
	$(CC) -c $(CFLAGS) $(INCPATH) -Foqgarray.obj ..\tools\qgarray.cpp

qgdict.obj: ..\tools\qgdict.cpp \
		..\..\include\qgdict.h \
		..\..\include\qcollection.h \
		..\..\include\qglobal.h \
		..\..\include\qlist.h \
		..\..\include\qglist.h \
		..\..\include\qgeneric.h \
		..\..\include\qstring.h \
		..\..\include\qarray.h \
		..\..\include\qgarray.h \
		..\..\include\qshared.h \
		..\..\include\qdatastream.h \
		..\..\include\qiodevice.h
	$(CC) -c $(CFLAGS) $(INCPATH) -Foqgdict.obj ..\tools\qgdict.cpp

qglist.obj: ..\tools\qglist.cpp \
		..\..\include\qglist.h \
		..\..\include\qcollection.h \
		..\..\include\qglobal.h \
		..\..\include\qgvector.h \
		..\..\include\qdatastream.h \
		..\..\include\qiodevice.h \
		..\..\include\qstring.h \
		..\..\include\qarray.h \
		..\..\include\qgarray.h \
		..\..\include\qshared.h \
		..\..\include\qgeneric.h
	$(CC) -c $(CFLAGS) $(INCPATH) -Foqglist.obj ..\tools\qglist.cpp

qglobal.obj: ..\tools\qglobal.cpp \
		..\..\include\qglobal.h \
		..\..\include\qdict.h \
		..\..\include\qgdict.h \
		..\..\include\qcollection.h \
		..\..\include\qgeneric.h \
		..\..\include\qstring.h \
		..\..\include\qarray.h \
		..\..\include\qgarray.h \
		..\..\include\qshared.h
	$(CC) -c $(CFLAGS) $(INCPATH) -Foqglobal.obj ..\tools\qglobal.cpp

qgvector.obj: ..\tools\qgvector.cpp \
		..\..\include\qgvector.h \
		..\..\include\qcollection.h \
		..\..\include\qglobal.h \
		..\..\include\qglist.h \
		..\..\include\qstring.h \
		..\..\include\qarray.h \
		..\..\include\qgarray.h \
		..\..\include\qshared.h \
		..\..\include\qgeneric.h \
		..\..\include\qdatastream.h \
		..\..\include\qiodevice.h
	$(CC) -c $(CFLAGS) $(INCPATH) -Foqgvector.obj ..\tools\qgvector.cpp

qiodevice.obj: ..\tools\qiodevice.cpp \
		..\..\include\qiodevice.h \
		..\..\include\qglobal.h
	$(CC) -c $(CFLAGS) $(INCPATH) -Foqiodevice.obj ..\tools\qiodevice.cpp

qstring.obj: ..\tools\qstring.cpp \
		..\..\include\qstring.h \
		..\..\include\qarray.h \
		..\..\include\qgarray.h \
		..\..\include\qshared.h \
		..\..\include\qglobal.h \
		..\..\include\qgeneric.h \
		..\..\include\qdatastream.h \
		..\..\include\qiodevice.h
	$(CC) -c $(CFLAGS) $(INCPATH) -Foqstring.obj ..\tools\qstring.cpp


####### Lex/yacc programs and options

LEX	=	flex
YACC	=	byacc -d

####### Lex/yacc files

LEXIN	=	moc.l
LEXOUT  =	lex.yy.c
YACCIN	=	moc.y
YACCOUT =	y.tab.c
YACCHDR =	y.tab.h
MOCGEN  =	mocgen.cpp

####### Process lex/yacc files

$(LEXOUT): $(LEXIN)
	$(LEX) $(LEXIN)

$(MOCGEN): $(YACCIN) $(LEXOUT)
	$(YACC) $(YACCIN)
	-del $(MOCGEN)
	-ren $(YACCOUT) $(MOCGEN)
