#! /bin/sh

# Compile a .glsl file to a file that can be included in a C++ program
USAGE="Usage: $0 -o <file.h> <file.glsl>"
CGC=cgc

if test $# -ne 3
then
    echo $USAGE
    exit 1
fi

while getopts o: opt
do
   case $opt in
      o) H_FILE=$OPTARG;;
      \?)  echo $USAGE; exit 1;;
   esac
done
shift `expr $OPTIND - 1`

GLSL_FILE=$1

echo "// Generated by src/gui/util/$0 from $1" > $H_FILE
$CGC -quiet -oglsl -profile arbfp1 $GLSL_FILE | while read line
do
   if test `echo $line | cut -c1` != "#"
   then
      echo '"'$line'"' >> $H_FILE
   fi
done
echo "; // Generated by src/gui/util/$0 from $1" >> $H_FILE

