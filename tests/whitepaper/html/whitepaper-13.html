<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- ./io-and-networking.leaf:3 -->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<title>Input/Output and Networking</title>
</head>
<body>
<p align="right">[<a href="whitepaper-12.html">Prev: Events</a>] [<a href="whitepaper.html">Home</a>] [<a href="whitepaper-14.html">Next: Collection Classes</a>]</p>
<h2 align="center">Input/Output and Networking</h2>
<h3><a name="1"></a>Input/Output</h3>
<!-- index serialization --><p>Qt provides classes to perform advanced I/O on multiple platforms. The <font color=darkblue><b>QTextStream</b></font> class has a similar interface to the standard <tt>&lt;iostream&gt;</tt> classes, and supports the encodings provided by <font color=darkblue><b>QTextCodec</b></font> (see <a href="whitepaper-8.html#1">Unicode</a>). The <font color=darkblue><b>QDataStream</b></font> class is used to serialize the basic C++ types and many Qt types in a platform-independent binary format. For example, the following code writes a C string, a font and a color to the file <tt>splash.dat</tt>:</p>
<pre>
    QFile file( "splash.dat" );
    if ( file.open(IO_WriteOnly) ) {
	QDataStream out( &amp;file );
	out &lt;&lt; "SplashScreenStyle"
	    &lt;&lt; QFont( "Times", 18, QFont::Bold )
	    &lt;&lt; QColor( "skyblue" );
    }
</pre>
<p>The data can easily be retrieved and used, for example:</p>
<pre>
    QCString str;
    QFont font;
    QColor color;

    QFile file( "splash.dat" );
    if ( file.open(IO_ReadOnly) ) {
	QDataStream in( &amp;file );
	in &gt;&gt; str &gt;&gt; font &gt;&gt; color;

	if ( str == "SplashScreenStyle" ) {
	    splash-&gt;setFont( font );
	    splash-&gt;setColor( color );
	}
    }
</pre>
<p>In practice, the above example would be written more concisely and easily using <a href="whitepaper-4.html#5">settings</a>.</p>
<p><font color=darkblue><b>QTextStream</b></font> and <font color=darkblue><b>QDataStream</b></font> operate on any <font color=darkblue><b>QIODevice</b></font> subclass. Qt includes the <font color=darkblue><b>QFile</b></font>, <font color=darkblue><b>QBuffer</b></font>, <font color=darkblue><b>QSocket</b></font> and <font color=darkblue><b>QSocketDevice</b></font> subclasses, and programmers can implement their own custom devices.</p>
<p>Directories are read and traversed using <font color=darkblue><b>QDir</b></font>. <font color=darkblue><b>QDir</b></font> can be used to manipulate path names and access the underlying file system (e.g. create a directory, delete a file). <font color=darkblue><b>QFileInfo</b></font> provides more detailed information about a file, such as its size, permissions, creation time, last modification time, etc.</p>
<p>The following example lists the hidden files in the user's home directory along with their size, in decreasing size order:</p>
<pre>
    QDir dir = QDir::home();
    dir.setFilter( QDir::Files | QDir::Hidden );
    dir.setSorting( QDir::Size | QDir::Reversed );
    QStringList names = dir.entryList();

    for ( int i = 0; i &lt; names.count(); i++ ) {
	QFileInfo info( dir, names[i] );
	cout &lt;&lt; names[i].latin1() &lt;&lt; " "
	     &lt;&lt; info.size() &lt;&lt; endl;
    }
</pre>
<p>Transparent access to remote files is provided by <font color=darkblue><b>QUrlOperator</b></font>. In addition to local file system access, Qt supports the the FTP and HTTP protocols and can be extended to support other protocols. For example, files can be downloaded using FTP like this:</p>
<pre>
    QUrlOperator op;
    op.copy( QString("ftp://ftp.trolltech.com/qt/INSTALL"),
	     QString("file:/tmp"), FALSE );
</pre>
<p>URLs can easily be parsed and recomposed using <font color=darkblue><b>QUrl</b></font>.</p>
<p>Image files are usually read in by creating a <font color=darkblue><b>QImage</b></font> with the file name as argument, as described in <a href="whitepaper-6.html#1-1">Images</a>.</p>
<h3><a name="2"></a>XML</h3>
<p>Qt's XML module provides a SAX parser and a DOM parser, both of which read well-formed XML and are non-validating. The SAX (Simple API for XML) implementation follows the design of the SAX2 Java implementation, with adapted naming conventions. The DOM (Document Object Model) Level 2 implementation follows the W3C recommendation and includes namespace support.</p>
<p>Many Qt applications use an XML format to store their persistent data. The SAX parser is used for reading data incrementally and is especially suitable for simple parsing requirements and for very large files. The DOM parser reads the entire file into a tree structure in memory that can be traversed at will.</p>
<h3><a name="3"></a>Inter-Process Communication</h3>
<p>The <font color=darkblue><b>QProcess</b></font> class is used to start external programs and to communicate with them from a Qt application in a platform-independent way. Communication is achieved by writing to the external program's standard input (<tt>stdin</tt>) and potentially by reading its standard output and standard error (<tt>stdout</tt>, <tt>stderr</tt>).</p>
<p><font color=darkblue><b>QProcess</b></font> works asynchronously, reporting the availability of data by emitting signals. Qt applications can connect to the signals to retrieve and process the data, and optionally respond by sending data back to the external program.</p>
<h3><a name="4"></a>Networking</h3>
<p>###</p>
<p>Qt provides a cross-platform interface for writing TCP/IP clients and servers. Clients are usually written using the <font color=darkblue><b>QSocket</b></font> class, a <font color=darkblue><b>QIODevice</b></font> subclass that provides a buffered non-blocking TCP connection.</p>
<p>Qt also provides <font color=darkblue><b>QServerSocket</b></font> for implementing servers.</p>
<p>and provides a low-level access to other protocol suites (e.g. Unix-domain protocols).</p>
<p>* QServerSocket * QSocket * QSocketDevice + QSocketNotifier</p>
<p><hr><ul> <li><a href=http://doc.trolltech.com/3.0/xml.html>http://doc.trolltech.com/3.0/xml.html</a> <li><a href=http://doc.trolltech.com/3.0/datastreamformat.html>http://doc.trolltech.com/3.0/datastreamformat.html</a> </ul></p>
<!-- eof -->
<p align="right">[<a href="whitepaper-12.html">Prev: Events</a>] [<a href="whitepaper.html">Home</a>] [<a href="whitepaper-14.html">Next: Collection Classes</a>]</p>
</body>
</html>
