#include <qapplication.h>
#include <qpainter.h>

#include "qfontdatabase.h"

#include <private/qcomplextext_p.h>
#include <qdatetime.h>
#include "editwidget.h"

// const char *family = "Arial Unicode Ms"; // generic
const char *family = "Diwani Letter,Verdana,Latha,Akaash,Serto Jerusalem,Mangal,Rama"; // Devanagari
// const char *family = ""; // arabic
// const char *family = ""; // syriac
// const char *family = ""; // Bengali
// const char *family = ""; // Tamil

//const char *s = "some string";
//const char * s = "××™ U ×™×•";

// const char * s = "××™×¨×•×¤×”, ×ª×•×›× ×” ×•×”××™× ×˜×¨× ×˜: Unicode ×™×•×¦× ×œ×©×•×§ ×”×¢×•×œ×ž×™ ×”×™×¨×©×ž×• ×›×¢×ª ×œ×›× ×¡ Unicode ×”×‘×™× ×œ××•×ž×™ ×”×¢×©×™×¨×™, ×©×™×™×¢×¨×š ×‘×™×Ÿ ×”×ª××¨×™×›×™× 12Ö¾10 ×‘×ž×¨×¥ 1997, ×‘×ž×™×™× ×¥ ×©×‘×’×¨×ž× ×™×”. ×‘×›× ×¡ ×™×©×ª×ª×¤×• ×ž×•×ž×—×™× ×ž×›×œ ×¢× ×¤×™ ×”×ª×¢×©×™×™×” ×‘× ×•×©× ×”××™× ×˜×¨× ×˜ ×”×¢×•×œ×ž×™ ×•×”Ö¾Unicode, ×‘×”×ª××ž×” ×œ×©×•×§ ×”×‘×™× ×œ××•×ž×™ ×•×”×ž×§×•×ž×™, ×‘×™×™×©×•× Unicode ×‘×ž×¢×¨×›×•×ª ×”×¤×¢×œ×” ×•×‘×™×™×©×•×ž×™×, ×‘×’×•×¤× ×™×, ×‘×¤×¨×™×¡×ª ×˜×§×¡×˜ ×•×‘×ž×—×©×•×‘ ×¨×‘Ö¾×œ×©×•× ×™. some english inbetween ×›××©×¨ ×”×¢×•×œ× ×¨×•×¦×” ×œ×“×‘×¨, ×”×•× ×ž×“×‘×¨ ×‘Ö¾Unicode ××™×¨×•×¤×”, ×ª×•×›× ×” ×•×”××™× ×˜×¨× ×˜: Unicode ×™×•×¦× ×œ×©×•×§ ×”×¢×•×œ×ž×™ ×”×™×¨×©×ž×• ×›×¢×ª ×œ×›× ×¡ Unicode ×”×‘×™× ×œ××•×ž×™ ×”×¢×©×™×¨×™, ×©×™×™×¢×¨×š ×‘×™×Ÿ ×”×ª××¨×™×›×™× 12Ö¾10 ×‘×ž×¨×¥ 1997, ×‘×ž×™×™× ×¥ ×©×‘×’×¨×ž× ×™×”. ×‘×›× ×¡ ×™×©×ª×ª×¤×• ×ž×•×ž×—×™× ×ž×›×œ ×¢× ×¤×™ ×”×ª×¢×©×™×™×” ×‘× ×•×©× ×”××™× ×˜×¨× ×˜ ×”×¢×•×œ×ž×™ ×•×”Ö¾Unicode, ×‘×”×ª××ž×” ×œ×©×•×§ ×”×‘×™× ×œ××•×ž×™ ×•×”×ž×§×•×ž×™, ×‘×™×™×©×•× Unicode ×‘×ž×¢×¨×›×•×ª ×”×¤×¢×œ×” ×•×‘×™×™×©×•×ž×™×, ×‘×’×•×¤× ×™×, ×‘×¤×¨×™×¡×ª ×˜×§×¡×˜ ×•×‘×ž×—×©×•×‘ ×¨×‘Ö¾×œ×©×•× ×™. some english inbetween ×›××©×¨ ×”×¢×•×œ× ×¨×•×¦×” ×œ×“×‘×¨, ×”×•× ×ž×“×‘×¨ ×‘Ö¾Unicode ××™×¨×•×¤×”, ×ª×•×›× ×” ×•×”××™× ×˜×¨× ×˜: Unicode ×™×•×¦× ×œ×©×•×§ ×”×¢×•×œ×ž×™ ×”×™×¨×©×ž×• ×›×¢×ª ×œ×›× ×¡ Unicode ×”×‘×™× ×œ××•×ž×™ ×”×¢×©×™×¨×™, ×©×™×™×¢×¨×š ×‘×™×Ÿ ×”×ª××¨×™×›×™× 12Ö¾10 ×‘×ž×¨×¥ 1997, ×‘×ž×™×™× ×¥ ×©×‘×’×¨×ž× ×™×”. ×‘×›× ×¡ ×™×©×ª×ª×¤×• ×ž×•×ž×—×™× ×ž×›×œ ×¢× ×¤×™ ×”×ª×¢×©×™×™×” ×‘× ×•×©× ×”××™× ×˜×¨× ×˜ ×”×¢×•×œ×ž×™ ×•×”Ö¾Unicode, ×‘×”×ª×";
//const char * s = "××™×¨×•×¤×”, ×ª×•×›× ×” ×•×”××™× ×˜×¨× ×˜: Unicode";


// const char *s = "Ø£ÙˆØ±ÙˆØ¨Ø§, Ø¨Ø±Ù…Ø¬ÙŠØ§Øª Ø§Ù„Ø­Ø§Ø³ÙˆØ¨ + Ø§Ù†ØªØ±Ù†ÙŠØª : ØªØµØ¨Ø­ Ø¹Ø§Ù„Ù…ÙŠØ§ Ù…Ø¹ ÙŠÙˆÙ†ÙŠÙƒÙˆØ¯ ØªØ³Ø¬Ù‘Ù„ Ø§Ù„Ø¢Ù† Ù„Ø­Ø¶ÙˆØ± Ø§Ù„Ù…Ø¤ØªÙ…Ø± Ø§Ù„Ø¯ÙˆÙ„ÙŠ Ø§Ù„Ø¹Ø§Ø´Ø± Ù„ÙŠÙˆÙ†ÙŠÙƒÙˆØ¯, Ø§Ù„Ø°ÙŠ Ø³ÙŠØ¹Ù‚Ø¯ ÙÙŠ 10-12 Ø¢Ø°Ø§Ø± 1997 Ø¨Ù…Ø¯ÙŠÙ†Ø© Ù…Ø§ÙŠÙ†ØªØ³, Ø£Ù„Ù…Ø§Ù†ÙŠØ§. ÙˆØ³ÙŠØ¬Ù…Ø¹ Ø§Ù„Ù…Ø¤ØªÙ…Ø± Ø¨ÙŠÙ† Ø®Ø¨Ø±Ø§Ø¡ Ù…Ù†  ÙƒØ§ÙØ© Ù‚Ø·Ø§Ø¹Ø§Øª Ø§Ù„ØµÙ†Ø§Ø¹Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø´Ø¨ÙƒØ© Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠØ© Ø§Ù†ØªØ±Ù†ÙŠØª ÙˆÙŠÙˆÙ†ÙŠÙƒÙˆØ¯, Ø­ÙŠØ« Ø³ØªØªÙ…, Ø¹Ù„Ù‰ Ø§Ù„ØµØ¹ÙŠØ¯ÙŠÙ† Ø§Ù„Ø¯ÙˆÙ„ÙŠ ÙˆØ§Ù„Ù…Ø­Ù„ÙŠ Ø¹Ù„Ù‰ Ø­Ø¯ Ø³ÙˆØ§Ø¡ Ù…Ù†Ø§Ù‚Ø´Ø© Ø³Ø¨Ù„ Ø§Ø³ØªØ®Ø¯Ø§Ù… ÙŠÙˆÙ†ÙƒÙˆØ¯  ÙÙŠ Ø§Ù„Ù†Ø¸Ù… Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© ÙˆÙÙŠÙ…Ø§ ÙŠØ®Øµ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª Ø§Ù„Ø­Ø§Ø³ÙˆØ¨ÙŠØ©, Ø§Ù„Ø®Ø·ÙˆØ·, these are some english words intermixed within the arabic text ØªØµÙ…ÙŠÙ… Ø§Ù„Ù†ØµÙˆØµ  ÙˆØ§Ù„Ø­ÙˆØ³Ø¨Ø© Ù…ØªØ¹Ø¯Ø¯Ø© Ø§Ù„Ù„ØºØ§Øª. Ø¹Ù†Ø¯Ù…Ø§ ÙŠØ±ÙŠØ¯ Ø§Ù„Ø¹Ø§Ù„Ù… Ø£Ù† ÙŠØªÙƒÙ„Ù‘Ù…, ÙÙ‡Ùˆ ÙŠØªØ­Ø¯Ù‘Ø« Ø¨Ù„ØºØ© ÙŠÙˆÙ†ÙŠÙƒÙˆØ¯.";
// const char *s = "Ø£ÙˆØ±ÙˆØ¨Ø§, Ø¨Ø±Ù…Ø¬ÙŠØ§Øª Ø§Ù„Ø­Ø§Ø³ÙˆØ";


// Thai
// const char *s = "à¸—à¸³à¹„à¸¡à¹€à¸‚à¸²à¸–à¸¶à¸‡à¹„à¸¡à¹ˆà¸žà¸¹à¸” ï¿½à¸²à¸©à¸²à¹„à¸—à¸¢";

// Vietnamese
// const char *s = "TaÌ£i sao hoÌ£ khÃ´ng thÃªÌ‰ chiÌ‰ noÌi tiÃªÌÌ£Ì£Ì£ng.";

// Syriac
// const char *s = "Ü Ü¡Ü¢ÜÜ ÜÜ¡Ü¡Ü Ü ÜÜ¢Ü£Ü˜ÜªÜÜÜ";

// Devanagari
const char *s = "à¤°à¥‚à¤¸ à¤•à¥‡ à¤°à¤¾à¤·à¥à¤Ÿà¥à¤°à¤ªà¤¤à¤¿ à¤µà¥à¤²à¤¾à¤¦à¤¿à¤®à¥€à¤° à¤ªà¥à¤¤à¤¿à¤¨ à¤¨à¥‡ à¤¬à¥€à¤œà¤¿à¤‚à¤— à¤ªà¤¹à¥à¤à¤šà¤•à¤° à¤šà¥€à¤¨ à¤•à¥‡ à¤°à¤¾à¤·à¥à¤Ÿà¥à¤°à¤ªà¤¤à¤¿ à¤œà¤¿à¤¯à¤¾à¤‚à¤— à¤œà¤¼à¥‡à¤®à¤¿à¤¨ à¤¸à¥‡ à¤¬à¤¾à¤¤à¤šà¥€à¤¤ à¤•à¥€. à¤¬à¤¾à¤¤à¤šà¥€à¤¤ à¤•à¥‡ à¤¬à¤¾à¤¦ à¤¸à¤‚à¤¯à¥à¤•à¥à¤¤ à¤˜à¥‹à¤·à¤£à¤¾ à¤®à¥‡à¤‚ à¤°à¥‚à¤¸ à¤”à¤° à¤šà¥€à¤¨ à¤¨à¥‡ à¤‰à¤¤à¥à¤¤à¤° à¤•à¥‹à¤°à¤¿à¤¯à¤¾, à¤‡à¤°à¤¾à¤•à¤¼ à¤”à¤° à¤¦à¥à¤µà¤¿à¤ªà¤•à¥à¤·à¥€à¤¯ à¤®à¤¾à¤®à¤²à¥‹à¤‚ à¤ªà¤° à¤…à¤ªà¤¨à¤¾ à¤ªà¤•à¥à¤· à¤°à¤–à¤¾. à¤°à¥‚à¤¸ à¤•à¥‡ à¤°à¤¾à¤·à¥à¤Ÿà¥à¤°à¤ªà¤¤à¤¿ à¤µà¥à¤²à¤¾à¤¦à¤¿à¤®à¥€à¤° à¤ªà¥à¤¤à¤¿à¤¨ à¤¨à¥‡ à¤¬à¥€à¤œà¤¿à¤‚à¤— à¤ªà¤¹à¥à¤à¤šà¤•à¤° à¤šà¥€à¤¨ à¤•à¥‡ à¤°à¤¾à¤·à¥à¤Ÿà¥à¤°à¤ªà¤¤à¤¿ à¤œà¤¿à¤¯à¤¾à¤‚à¤— à¤œà¤¼à¥‡à¤®à¤¿à¤¨ à¤¸à¥‡ à¤¬à¤¾à¤¤à¤šà¥€à¤¤ à¤•à¥€. à¤¬à¤¾à¤¤à¤šà¥€à¤¤ à¤•à¥‡ à¤¬à¤¾à¤¦ à¤¸à¤‚à¤¯à¥à¤•à¥à¤¤ à¤˜à¥‹à¤·à¤£à¤¾ à¤®à¥‡à¤‚ à¤°à¥‚à¤¸ à¤”à¤° à¤šà¥€à¤¨ à¤¨à¥‡ à¤‰à¤¤à¥à¤¤à¤° à¤•à¥‹à¤°à¤¿à¤¯à¤¾, à¤‡à¤°à¤¾à¤•à¤¼ à¤”à¤° à¤¦à¥à¤µà¤¿à¤ªà¤•à¥à¤·à¥€à¤¯ à¤®à¤¾à¤®à¤²à¥‹à¤‚ à¤ªà¤° à¤…à¤ªà¤¨à¤¾ à¤ªà¤•à¥à¤· à¤°à¤–à¤¾.";


// Bengali
// const char * s = "à¦…à¦¾à¦¬à¦¾à¦° à¦…à¦¾à¦¸à¦¿à¦¬ à¦«à¦¿à¦°à§‡ à¦§à¦¾à¦¨à¦¸à¦¿à§œà¦¿à¦Ÿà¦¿à¦° à¦¤à§€à¦°à§‡ - à¦à¦‡ à¦¬à¦¾à¦‚à¦²à¦¾à§Ÿ à¦¹à§Ÿà¦¤à§‹ à¦®à¦¾à¦¨à§à¦· à¦¨à§Ÿ - à¦¹à§Ÿà¦¤à§‹ à¦¬à¦¾ à¦¶à¦™à§à¦–à¦šà¦¿à¦² à¦¶à¦¾à¦²à¦¿à¦–à§‡à¦° à¦¬à§‡à¦¶à§‡, à¦¹à§Ÿà¦¤à§‹ à¦­à§‹à¦°à§‡à¦° à¦•à¦¾à¦• à¦¹à§Ÿà§‡ à¦à¦‡ à¦•à¦¾à¦°à§à¦¤à¦¿à¦•à§‡à¦° à¦¨à¦¬à¦¾à¦¨à§à¦¨à§‡à¦° à¦¦à§‡à¦¶à§‡  à¦•à§à§Ÿà¦¾à¦¶à¦¾à¦° à¦¬à§à¦•à§‡ à¦­à§‡à¦¸à§‡ à¦à¦•à¦¦à¦¿à¦¨ à¦…à¦¾à¦¸à¦¿à¦¬ à¦à¦‡ à¦•à¦¾à¦à¦ à¦¾à¦² - à¦›à¦¾à§Ÿà¦¾à§Ÿ, à¦¹à§Ÿà¦¤à§‹ à¦¬à¦¾ à¦¹à¦¾à¦à¦¸ à¦¹à¦¬ - à¦•à¦¿à¦¶à§‹à¦°à§€à¦° - à¦˜à§à¦™à§à¦° à¦°à¦¹à¦¿à¦¬à§‡ à¦²à¦¾à¦² à¦ªà¦¾à§Ÿà§‡, à¦¸à¦¾à¦°à¦¾à¦¦à¦¿à¦¨ à¦•à§‡à¦Ÿà§‡ à¦¯à¦¾à¦¬à§‡ à¦•à¦²à¦®à§€à¦° à¦—à¦¨à§à¦§ à¦­à¦°à¦¾ à¦œà¦²à§‡ à¦­à§‡à¦¸à§‡ à¦­à§‡à¦¸à§‡, à¦…à¦¾à¦¬à¦¾à¦° à¦…à¦¾à¦¸à¦¿à¦¬ à¦…à¦¾à¦®à¦¿ à¦¬à¦¾à¦‚à¦²à¦¾à¦° à¦¨à¦¦à§€ à¦®à¦¾à¦  à¦•à§à¦·à§‡à¦¤ à¦­à¦¾à¦²à§‹à¦¬à§‡à¦¸à§‡ à¦œà¦²à¦™à§à¦—à§€à¦° à¦¢à§‡à¦‰à§Ÿà§‡ à¦­à§‡à¦œà¦¾ à¦¬à¦¾à¦‚à¦²à¦¾à¦° à¦ à¦¸à¦¬à§à¦œ à¦•à¦°à§à¦£ à¦¡à¦¾à¦™à¦¾à§Ÿ";

// mixed
// const char *s =
// "Thai: à¸—à¸³à¹„à¸¡à¹€à¸‚à¸²à¸–à¸¶à¸‡à¹„à¸¡à¹ˆà¸žà¸¹à¸” "
// "Syriac: Ü Ü¡Ü¢ÜÜ ÜÜ¡Ü¡Ü Ü ÜÜ¢Ü£Ü˜ÜªÜÜÜ "
// "Arabic: Ø£ÙˆØ±ÙˆØ¨Ø§, Ø¨Ø±Ù…Ø¬ÙŠØ§Øª Ø§Ù„Ø­Ø§Ø³ÙˆØ¨ "
// "Hebrew: ×ª×•×›× ×” ×•×”××™× ×˜×¨× ×˜ "
// "Devanagari: à¤°à¥‚à¤¸ à¤•à¥‡ à¤°à¤¾à¤·à¥à¤Ÿà¥à¤°à¤ªà¤¤à¤¿ "
// "Bengali: à¦…à¦¾à¦¬à¦¾à¦° à¦…à¦¾à¦¸à¦¿à¦¬ à¦«à¦¿à¦°à§‡ "
// ;

// latin
// const char *s =
// "KDE is a powerful Open Source graphical desktop environment for Unix workstations. It combines ease of use, contemporary functionality, and outstanding graphical design with the technological superiority of the Unix operating system. KDE is an Internet project that is truly open in every sense. Development takes place on the Internet and is discussed on our mailing lists, USENET news groups, and IRC channels to which we invite and welcome everyone."
// ;



// const char *s = "";

int main( int argc, char **argv )
{
    QApplication a(argc, argv);

    QFontDatabase fdb;

    return 0;

    QFont f( family );
    f.setPointSize( 24 );
    a.setFont( f );

#if 0
    QString str = QString::fromUtf8( s );
    QTime t;
    t.start();
    QFontMetrics fm( f );
    (void)fm.width( str );
    qDebug("loading took %d ms",  t.elapsed() );

    QStringList list1, list2;
    QStringList::const_iterator it1, end1, it2, end2;

    list1 = fdb.families();
    qDebug( "%d families", list1.count() );

    // each family
    for ( it1 = list1.begin(), end1 = list1.end(); it1 != end1; ++it1 ) {
	list2 = fdb.styles( *it1 );
	qDebug( "\n\nfamily '%s', fixed: %d, styles:",
		(*it1).latin1(), fdb.isFixedPitch( *it1, QString::null ) );

	// each style
	for ( it2 = list2.begin(), end2 = list2.end(); it2 != end2; ++it2 ) {
	    qDebug( "  %s:\n    scalable %d (smooth %d bitmap %d)",
		    (*it2).latin1(),
		    fdb.isScalable( *it1, *it2 ),
		    fdb.isSmoothlyScalable( *it1, *it2 ),
		    fdb.isBitmapScalable( *it1, *it2 ) );

	    qDebug( "    point sizes %d\n    smooth sizes %d",
		    fdb.pointSizes( *it1, *it2 ).count(),
		    fdb.smoothSizes( *it1, *it2 ).count() );
	}
    }

    return 0;
#endif

    QFontMetrics( f ).boundingRect( 0, 0, 50000, 1000, Qt::SingleLine, QString::fromUtf8( s ) );
    QTime t;
    t.start();
    QFontMetrics( f ).boundingRect( 0, 0, 50000, 1000, Qt::WordBreak, QString::fromUtf8( s ) );
    qDebug("fm.boundingrect() took %dms (%dus/char)", t.elapsed(), t.elapsed()*1000/QString::fromUtf8( s ).length() );

    EditWidget *w = new EditWidget( 0, 0 );
    w->setText( QString::fromUtf8( s ) );
    w->resize( 600, 300 );
    w->show();
    a.setMainWidget ( w );

    a.exec();
    delete w;
}
