# @Ftp{URI}
# @Http{URI}
# @Key{key combination} e.g. @Key{Alt+P}
# @News{URI}
# @Shadow{ text }
# @Sidebar		e.g. { Caption } @Sidebar { Body }
# @PageRef{tag}		shows [p. 91]
# @TitlePageRef{tag}	shows ``Chapter Title'' [p. 51]
# @TitleRef{tag}	shows ``Chapter Title''

macro @QAT { Slope @Font @OneCol{Qt Assistant} }
macro @QDR { Slope @Font @OneCol{Qt Designer} }
macro @QLT { Slope @Font @OneCol{Qt Linguist} }
macro @QQ { {1.05 @Scale { Chancery BoldSlope } @Font { Qt Quarterly }} }

macro @Asterisk { { Dingbats Base } @Font { H } }
macro @Bsterisk { { Dingbats Base } @Font { J } }
macro @Number {N{+0.25f @VShift{0.8 @Scale{@Underline o}}}} # N°

macro @TTGreenColour		{{cmyk 0.40 0.00 1.00 0.01}}
macro @LightGreyColour		{{rgb 0.90 0.90 0.90}}
macro @SidebarTitleBgColour	{ darkcyan }
macro @SidebarTitleColour	{ white } 
macro @SidebarBgColour		{ @LightGreyColour }


import @BasicSetup
def @Key right x {
    @CurveBox margin { 0.1f } paint { grey } 
    @CurveBox margin { 0.2f } paint { lightgrey } 
    { Helvetica Base -3p } @Font x 
}


import @BasicSetup 
def @Sidebar
    left title
    named @Type {}
    right x
{
    def @DetailsPlace { @Galley }
    def @SendDetails into { @DetailsPlace&&preceding } right x { @OneCol x }

    @OneRow @CD 
    @Tbl
	rule { yes }
	aformat { 
	    @Cell iv { ctr }
		  paint { 
			@Type @Case {
			    tip	     @Yield { lightyellow }
			    caution  @Yield { lightred }
			    exercise @Yield { lightcyan }
			    note     @Yield { lightgreen }
			    else     @Yield { lightgrey }
			}
		    } A 
		}
    {
	@Rowa 
	    A { 
		1c @Wide 
		@Type @Case {
		    tip	     @Yield { { Dingbats Base +2p } @Font 4 } 
		    caution  @Yield { { Dingbats Base +2p } @Font 8 } 
		    exercise @Yield { { Dingbats Base +2p } @Font + } 
		    note     @Yield { { Dingbats Base +2p } @Font - } 
		    else     @Yield { @Diag { 
					@Circle margin { 0.2f } 
					{ Times Bold -1p } @Font i } } 
		}
		@B title 
	    }
	@Rowa 
	    A { x }
    }
    //
    @SendDetails x
}


def @Ftp  right x { @HContract{ftp{:|0.15s{"/"|0.4fo "/"}x}}}
def @Http right x { @HContract{http{:|0.15s{"/"|0.4fo "/"}x}}}
def @News right x { @HContract{news{:|0.15s{"/"|0.4fo "/"}x}}}

import @BasicSetup 
def @TitlePageRef right x { 
    x @Case {
	"" @Yield red @Colour { ?? }
	else @Yield {@TitleOf x [p.~@PageOf{x}]} 
    }
}

import @BasicSetup 
def @TitleRef right x { 
    x @Case {
	"" @Yield red @Colour { ?? }
	else @Yield {@TitleOf x} 
    }
}

import @BasicSetup 
def @PageRef right x { 
    x @Case {
	"" @Yield red @Colour { ?? }
	else @Yield {[p.~@PageOf{ x }]} 
    }
}


import @BasicSetup
def @Shadow 
    named colour { black }
    named shade { lightgrey }
    named offset { 0.125f }
    right x 
{
    -offset @VShift shade @Colour x 
    @OverStrike 
    colour @Colour +offset @HShift +offset @VShift x
}


