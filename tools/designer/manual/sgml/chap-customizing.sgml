<chapter>
<title>Customizing and Integrating Qt Designer</title>

<sect1 id="customizingqtdesigner">
<title>Customizing Qt Designer </title>
<para id="aioy">
<emphasis>Qt Designer</> can be customized in two ways: you can add custom widgets, and you
can change aspects of how <emphasis>Qt Designer</> works. Custom widgets are covered in <xref
linkend="creating-custom-widgets-with-plugins"> "Creating Custom
Widgets". This section will focus on customizing <emphasis>Qt Designer</> itself.
</para>
<para id="aipe">
<emphasis>Qt Designer</>'s toolbars are all dockable so they can be dragged by their toolbar
handles and arranged how you like. The Files, Object Hierarchy, Property
Editor and Output Windows are also dockable so you can also drag them to
the positions that you prefer. You can also make them into floating
windows by dragging them outside <emphasis>Qt Designer</>'s dock areas.
</para>
<para id="aipl">
General preferences can be set by clicking
<indexterm><primary>Menu Options</primary><secondary>Edit|Preferences</secondary></indexterm>
<guimenuitem>Edit|Preferences</> to invoke the <indexterm><primary>Dialogs</primary><secondary>Preferences</secondary></indexterm>
Preferences
dialog. If you check the 'Restore last workspace on startup' checkbox
then <emphasis>Qt Designer</> will remember the sizes and positions of the toolbars and the
dockable windows. You can change <emphasis>Qt Designer</>'s main window background either by
selecting a color or a pixmap. You can also switch off the grid (uncheck
Show Grid) since using layouts makes the grid redundant.
</para>
<para id="aipu">
<indexterm><primary>Plugins</primary></indexterm>

<indexterm><primary>Code Editing</primary><secondary>Preferences</secondary></indexterm>

<indexterm><primary>Preferences</primary><secondary>Code Editing</secondary></indexterm>

The <indexterm><primary>Dialogs</primary><secondary>Preferences</secondary></indexterm>
Preferences dialog may have additional tabs, depending on what
plugins you have installed. We'll describe the C++ Editor tab since this
is installed by default.
</para>
<para id="aipz">
The C++ Editor tab is used to set your preferred fonts for
syntax highlighting in <emphasis>Qt Designer</>'s code editor. The base font for all elements
is set in the 'Standard' element which is the last item in the list.
If you want one font to be used throughout then set the 'Standard' font
and all the other elements will inherit its setting. 
</para>

<sect2 id="qtdesignerscodeeditor">
<title>Qt Designer's Code Editor</title>
<para id="aiqj">
The code editor is available if an Editor plugin is installed. The C++
Editor plugin is installed by default.
</para>
<para id="aiqn">
<indexterm><primary>Keypresses (Qt Designer's code editor)</primary></indexterm>

The code editor provides the following keystrokes:
<itemizedlist>
<listitem><para id="aiqq">Left Arrow -- Moves the cursor one character left</para></listitem>
<listitem><para id="aiqr">Right Arrow -- Moves the cursor one character right</para></listitem>
<listitem><para id="aiqs">Up Arrow -- Moves the cursor one line up</para></listitem>
<listitem><para id="aiqt">Down Arrow -- Moves the cursor one line down</para></listitem>
<listitem><para id="aiqu">Page Up -- Moves the cursor one page up</para></listitem>
<listitem><para id="aiqv">Page Down -- Moves the cursor one page down</para></listitem>
<listitem><para id="aiqw">Backspace -- Deletes the character to the left of the cursor</para></listitem>
<listitem><para id="aiqx">Home -- Moves the cursor to the beginning of the line</para></listitem>
<listitem><para id="aiqy">End -- Moves the cursor to the end of the line</para></listitem>
<listitem><para id="aiqz">Delete -- Deletes the character to the right of the cursor</para></listitem>
<listitem><para id="aira">Ctrl+A -- Moves the cursor to the beginning of the line</para></listitem>
<listitem><para id="airb">Ctrl+B -- Moves the cursor one character left</para></listitem>
<listitem><para id="airc">Ctrl+C -- Copies the selected text to the clipboard (also Ctrl+Insert under Windows)</para></listitem>
<listitem><para id="aird">Ctrl+D -- Deletes the character to the right of the cursor</para></listitem>
<listitem><para id="aire">Ctrl+E -- Moves the cursor to the end of the line</para></listitem>
<listitem><para id="airf">Ctrl+F -- Invokes the <indexterm><primary>Dialogs</primary><secondary>Find Text</secondary></indexterm>
Find Text dialog</para></listitem>
<listitem><para id="airg">Ctrl+G -- Invokes the <indexterm><primary>Dialogs</primary><secondary>Goto Line</secondary></indexterm>
Goto Line dialog</para></listitem>
<listitem><para id="airh">Ctrl+H -- Deletes the character to the left of the cursor</para></listitem>
<listitem><para id="airi">Ctrl+I -- Indent the line or selected text that contains the cursor</para></listitem>
<listitem><para id="airj">Alt+I -- Starts incremental search (see below)</para></listitem>
<listitem><para id="airk">Ctrl+K -- Deletes from the cursor position to the end of
the line</para></listitem>
<listitem><para id="airm">Ctrl+N -- Moves the cursor one line down</para></listitem>
<listitem><para id="airn">Ctrl+P -- Moves the cursor one line up</para></listitem>
<listitem><para id="airo">Ctrl+R -- Invokes the <indexterm><primary>Dialogs</primary><secondary>Replace Text</secondary></indexterm>
Replace Text dialog</para></listitem>
<listitem><para id="airp">Ctrl+V -- Pastes the clipboard text into line edit (also Shift+Insert under Windows)</para></listitem>
<listitem><para id="airq">Ctrl+X -- Cuts the marked text, copy to clipboard (also Shift+Delete under Windows)</para></listitem>
<listitem><para id="airr">Ctrl+Y -- Redoes the last operation</para></listitem>
<listitem><para id="airs">Ctrl+Z -- Undoes the last operation</para></listitem>
<listitem><para id="airt">Ctrl+Left Arrow -- Moves the cursor one word left</para></listitem>
<listitem><para id="airu">Ctrl+Right Arrow -- Moves the cursor one word right</para></listitem>
<listitem><para id="airv">Ctrl+Up Arrow -- Moves the cursor one word up</para></listitem>
<listitem><para id="airw">Ctrl+Down Arrow -- Moves the cursor one word down</para></listitem>
<listitem><para id="airx">Ctrl+Home Arrow -- Moves the cursor to the beginning of the text</para></listitem>
<listitem><para id="airy">Ctrl+End Arrow -- Moves the cursor to the end of the text</para></listitem>
<listitem><para id="airz">Tab -- Completion (see below)</para></listitem>
</itemizedlist>
</para>
<para id="aisc">
To select (mark) text hold down the Shift key whilst pressing one of the
movement keystrokes, for example, <indexterm><primary>Keypresses (Qt Designer)</primary><secondary>Shift+Right Arrow</secondary></indexterm>
<keycap>Shift+Right Arrow</>
will select the character to the right, and 
<indexterm><primary>Keypresses (Qt Designer)</primary><secondary>Shift+Ctrl+Right Arrow</secondary></indexterm>
<keycap>Shift+Ctrl+Right Arrow</> will select the word to the right, etc.
</para>
<para id="aisi">
Pressing <indexterm><primary>Keypresses (Qt Designer)</primary><secondary>Alt+I</secondary></indexterm>
<keycap>Alt+I</> starts incremental search. The
characters you type will appear in the Incremental Search line edit in
the Search toolbar and the cursor will be moved to the first matching
text in the editor. As you type the search will continue. Press
<indexterm><primary>Keypresses (Qt Designer)</primary><secondary>Return</secondary></indexterm>
<keycap>Return</> to move to the next match and press
<indexterm><primary>Keypresses (Qt Designer)</primary><secondary>Esc</secondary></indexterm>
<keycap>Esc</> to cancel the search at the position you've
reached.
</para>
<para id="aisr">
Pressing <indexterm><primary>Keypresses (Qt Designer)</primary><secondary>Tab</secondary></indexterm>
<keycap>Tab</> after you've typed one or more characters
invokes completion. Completion works like this:
start typing some text then press <indexterm><primary>Keypresses (Qt Designer)</primary><secondary>Tab</secondary></indexterm>
<keycap>Tab</>. If the editor
can find another item of text that begins with the same characters it
will complete your text for you; if it finds more than one possibility
it will pop up a list of choices. You can use the arrow keys to choose a
piece of text then press <indexterm><primary>Keypresses (Qt Designer)</primary><secondary>Return</secondary></indexterm>
<keycap>Return</>, or press
<indexterm><primary>Keypresses (Qt Designer)</primary><secondary>Esc</secondary></indexterm>
<keycap>Esc</> to continue typing. You can switch off completion
in the <indexterm><primary>Dialogs</primary><secondary>Preferences</secondary></indexterm>
Preferences dialog.
</para>
<para id="aitc">
When you enter
<literal>-&gt;</literal> or <literal>.</literal> the editor will pop up
a command completion list; use the arrow keys to move to the item you
want and press <indexterm><primary>Keypresses (Qt Designer)</primary><secondary>Return</secondary></indexterm>
<keycap>Return</>, or press <indexterm><primary>Keypresses (Qt Designer)</primary><secondary>Esc</secondary></indexterm>
<keycap>Esc</> to
ignore the list.
</para>
</sect2>

</sect1>


<sect1 id="creatingandusingtemplates">
<title>Creating and Using Templates </title>
<para id="aitq">
<indexterm><primary>Creating Templates</primary></indexterm>

<indexterm><primary>Templates</primary><secondary>Creating and Using</secondary></indexterm>

<emphasis>Qt Designer</> supports two approaches to creating template forms. The simplest
approach involves little more than saving a <indexterm><primary>Files and file types</primary><secondary>.ui</secondary></indexterm>
<filename>.ui</>
file into the templates directory. The second approach involves creating
a container widget class to be used as a base class for forms that use
the template. We will explain both techniques.
</para>


<sect2 id="simpletemplates">
<title>Simple Templates </title>
<para id="aiub">
These templates are most useful when you want to create a whole set of
forms which all have some common widgets. For example, you might have a
project that will require many forms, all of which need to be branded
with a company name and logo.
</para>

<para id="aiui">
First we'll create the simple template.
<orderedlist numeration="arabic">
<listitem>
<para id="aium">
Click <indexterm><primary>Menu Options</primary><secondary>File|New</secondary></indexterm>
<guimenuitem>File|New</> to invoke the <indexterm><primary>Dialogs</primary><secondary>New Form</secondary></indexterm>
New Form dialog.
Click the Dialog template then click <guibutton>OK</>.
</para>
</listitem>
<listitem>
<para id="aius">
Click the <indexterm><primary>Toolbar Buttons</primary><secondary>Text Label</secondary></indexterm>
<indexterm><primary>Widgets</primary><secondary>Text Label</secondary></indexterm>
<guibutton>Text Label</> toolbar button, then click
near the top left of the form. Change the font Point Size property to 16
and change the <indexterm><primary>Properties</primary><secondary>text</secondary></indexterm>
text property to your or your company's name. Click the
<indexterm><primary>Toolbar Buttons</primary><secondary>Line</secondary></indexterm>
<indexterm><primary>Widgets</primary><secondary>Line</secondary></indexterm>
<guibutton>Line</> toolbar button, then click the form below
the label; click Horizontal on the pop-up menu.
</para>
</listitem>
<listitem>
<para id="aivb">
Select the label and the line. (<indexterm><primary>Keypresses (Qt Designer)</primary><secondary>Ctrl+Click</secondary></indexterm>
<keycap>Ctrl+Click</> the form, then drag the
rubber band so that it touches or includes the line and the label.)
Press <indexterm><primary>Keypresses (Qt Designer)</primary><secondary>Ctrl+L</secondary></indexterm>
<keycap>Ctrl+L</> to lay them out vertically.
</para>
</listitem>
<listitem>
<para id="aivi">
Click the <indexterm><primary>Toolbar Buttons</primary><secondary>Save</secondary></indexterm>
<indexterm><primary>Widgets</primary><secondary>Save</secondary></indexterm>
<guibutton>Save</> toolbar button. In the <indexterm><primary>Dialogs</primary><secondary>Save As</secondary></indexterm>
Save As
dialog, navigate to <emphasis>Qt Designer</>'s templates directory, e.g.
(<filename>qt/tools/designer/templates</>.
Type in the name 'Simple_Dialog.ui' and click
<guibutton>Save</>. 
</para>
</listitem>
<listitem>
<para id="aivr">
Right click the form in the Forms list, then click Remove form from
project.
</para>
</listitem>
</orderedlist>
</para>

<para id="aivz">
Now that we have the simple template we are ready to use it. Click
<indexterm><primary>Menu Options</primary><secondary>File|New</secondary></indexterm>
<guimenuitem>File|New</> to invoke the <indexterm><primary>Dialogs</primary><secondary>New Form dialog</secondary></indexterm>
New Form dialog. One
of the templates that will appear is 'Simple Dialog'. Click the simple
dialog, then click <guibutton>OK</>. A new form will appear with the same widgets and
layout as the template. Add any other widgets and functionality. When
you attempt to save the form you will be prompted for a new form name. 
</para>

</sect2>

<sect2 id="baseclasstemplates">
<title>Base-class Templates </title>
<para id="aiwm">
<indexterm><primary>Templates</primary><secondary>Base Class Templates</secondary></indexterm>

These templates are useful when you want to provide some default
functionality that all the forms based on the base class can inherit.
In our example we'll use a class called
<indexterm><primary>SizeAware</primary></indexterm>
<classname>SizeAware</> that remembers and restores its size as
the basis of a template.
We won't describe the class itself, but will focus instead on making use
of it as a <emphasis>Qt Designer</> template. The source for the class is in
<filename>qt/tools/designer/examples/sizeaware</>.
</para>

<para id="aiwx">
The template can either be based on a custom widget or on any existing
container widget.
</para>
<para id="aixb">
If you want to base the template on a custom widget you must first add
it to <emphasis>Qt Designer</>'s custom widgets.
Click <indexterm><primary>Menu Options</primary><secondary>Tools|Custom|Edit Custom Widgets</secondary></indexterm>
<guimenuitem>Tools|Custom|Edit Custom Widgets</> to
invoke the <indexterm><primary>Dialogs</primary><secondary>Edit Custom Widgets</secondary></indexterm>
Edit Custom Widgets dialog. (This dialog is explained in more
detail in <xref linkend="old-custom-widgets"> "Simple Custom Widgets".)
Click <guibutton>New Widget</>. Change the Class from
'MyCustomWidget' to 'SizeAware'. Click the Headerfile ellipsis button
and select the file 
<filename>qt/tools/designer/examples/sizeaware/sizeaware.h</>. Check
the Container Widget checkbox. This
class provides two properties. Click the Properties tab. Click
<guibutton>New Property</> and change the property name to
'company'. Click the <guibutton>New Property</> again and change
the property name to 'settingsFile'. Click <guibutton>Close</>.
</para>
<para id="aixr">
To create a template, based on an existing widget or on your own custom
widget, click <indexterm><primary>Menu Options</primary><secondary>File|Create Template</secondary></indexterm>
<guimenuitem>File|Create Template</> to invoke
the <indexterm><primary>Dialogs</primary><secondary>Create Template</secondary></indexterm>
Create Template dialog. Change the Template Name to 'SizeAware' and
click the SizeAware base class, then click
<guibutton>Create</>. The dialog will create the template and
close itself immediately. Close <emphasis>Qt Designer</> and restart it.
</para>

<para id="aiya">
A new template, 'SizeAware' is now available from the list of templates.
Click <indexterm><primary>Menu Options</primary><secondary>File|New</secondary></indexterm>
<guimenuitem>File|New</>, click SizeAware and click
<guibutton>OK</>. Note that the two properties, company and settingsFile, are
available in the Properties window. Any forms based on this template
will remember their size and resize when reloaded. (In practical
applications having one settingsFile per form is not recommended, so
this template would only really be useful for applications that have a
single main window.)
</para>

</sect2>

</sect1>


<sect1 id="integratingqtdesignerwithothertools">
<title>Integrating Qt Designer with Visual Studio </title>
<para id="aiys">
<emphasis>Qt Designer</> can be integrated into Visual Studio using the
<indexterm><primary>Files and file types</primary><secondary>qmsdev.dsp</secondary></indexterm>
<filename>qmsdev.dsp</> file that is supplied with Qt.
</para>
<para id="aiyw">
<indexterm><primary>Visual Studio</primary></indexterm>

Start up Visual Studio and click <guimenuitem>File|Open
Workspace</guimenuitem>. Open
<filename>%QTDIR%\tools\designer\integration\qmsdev\qmsdev.dsp</>.
Click <indexterm><primary>Menu Options</primary><secondary>Build|Set Active Configuration</secondary></indexterm>
<guimenuitem>Build|Set Active Configuration</> and in
the list click 'QMsDev - Win32 Release', then click <guibutton>OK</>. Now click
<indexterm><primary>Menu Options</primary><secondary>Build|Build qmsdev.dll</secondary></indexterm>
<guimenuitem>Build|Build qmsdev.dll</>. You should now copy
the file
<filename>%QTDIR%\tools\designer\integration\qmsdev\Release\qmsdev.dll</>
into 
<filename>\Program Files\Microsoft Visual Studio\Common\MSDev98\AddIns</>. 
Now click <indexterm><primary>Menu Options</primary><secondary>Tools|Customize</secondary></indexterm>
<guimenuitem>Tools|Customize</>. Click the Add-in Macro Files
tab, then click the <guibutton>Browse</> button. Change the
file type to 'Add-ins (.dll)' and navigate to 
<filename>\Program Files\Microsoft Visual Studio\Common\MSDev98\AddIns</>. 
Click the <indexterm><primary>Files and file types</primary><secondary>qmsdev.dll</secondary></indexterm>
<filename>qmsdev.dll</> file, click
<guibutton>Open</>, then click <guibutton>Close</>.
</para>
<para id="aizo">
A new toolbar will appear in Visual Studio with the following toolbar
buttons:
<itemizedlist>
<listitem><para id="aizs">New Qt Project -- A small application wizard</para></listitem>
<listitem><para id="aizt">Generate Qt Project -- Runs <indexterm><primary>qmake</primary></indexterm>
<command>qmake</> (or the functionally equivalent <indexterm><primary>tmake</primary></indexterm>
<command>tmake</>) with a <indexterm><primary>Files and file types</primary><secondary>.pro</secondary></indexterm>
<filename>.pro</> file</para></listitem>
<listitem><para id="aizu">New Qt Dialog -- Add an empty Qt Dialog to the active project</para></listitem>
<listitem><para id="aizv">Qt GUI Designer -- Run <emphasis>Qt Designer</></para></listitem>
<listitem><para id="aizw">Use Qt -- Add the Qt libraries to the active project</para></listitem>
<listitem><para id="aizx">Add MOC -- Add the <indexterm><primary>moc</primary></indexterm>
<command>moc</> precompiler to the active file</para></listitem>
<listitem><para id="aizy">Add UIC -- Add the <indexterm><primary>uic</primary></indexterm>
<command>uic</> precompiler to the active file</para></listitem></itemizedlist>
Double clicking a <indexterm><primary>Files and file types</primary><secondary>.ui</secondary></indexterm>
<filename>.ui</> file in the workspace
overview will now launch <emphasis>Qt Designer</>.
</para>
<para id="ajac">
<indexterm><primary>Macros</primary><secondary>Q_OBJECT</secondary></indexterm>

<indexterm><primary>Q_OBJECT</primary></indexterm>

If you create a <indexterm><primary>Files and file types</primary><secondary>.cpp</secondary></indexterm>
<filename>.cpp</> file which contains the
<literal>Q_OBJECT</literal> macro you will need an additional file which
is generated by the <indexterm><primary>moc</primary></indexterm>
<command>moc</> to be included in your project. For
example, if you have 'file.cpp', then the last line would be
<literal>#include "file.moc"</literal> and the additional file would be
called 'file.moc'. To ensure that Visual Studio executes the <indexterm><primary>moc</primary></indexterm>
<command>moc</>
and generates this file you must create a custom dependency.
Double click the <indexterm><primary>Files and file types</primary><secondary>.cpp</secondary></indexterm>
<filename>.cpp</> file (in your project
workspace) that contains the <literal>Q_OBJECT</literal> macro. Click
the <guibutton>Add MOC</> toolbar button; this will create an
empty <indexterm><primary>Files and file types</primary><secondary>.moc</secondary></indexterm>
<filename>.moc</> file in your project workspace. Right
click the newly created <indexterm><primary>Files and file types</primary><secondary>.moc</secondary></indexterm>
<filename>.moc</> file, then click
<indexterm><primary>Menu Options</primary><secondary>Settings</secondary></indexterm>
<guimenuitem>Settings</> from the pop-up menu to invoke the
<indexterm><primary>Dialogs</primary><secondary>Project Settings</secondary></indexterm>
Project Settings dialog. Click the Custom Build tab. Click the
<guibutton>Dependencies</> button to pop up the User Defined
Dependencies dialog. Type in
<literal>$(InputDir)\$(InputPath)</literal>, then press
<indexterm><primary>Keypresses (Qt Designer)</primary><secondary>Return</secondary></indexterm>
<keycap>Return</>. Click <guibutton>OK</> to leave the Dependencies dialog,
then click <guibutton>OK</> to leave the Project Settings dialog.
</para>
<para id="ajax">
If you wish to delete the add-in remove it from the toolbar then delete
the <indexterm><primary>Files and file types</primary><secondary>qmsdev.dll</secondary></indexterm>
<filename>qmsdev.dll</> file from the add-ins directory. 
</para>

<sect2 id="creatingmakefileswithoutqmake">
<title>Creating Makefiles without qmake </title>
<para id="ajbe">
<indexterm><primary>Makefiles</primary></indexterm>

The <indexterm><primary>qmake</primary></indexterm>
<command>qmake</> tool provided with Qt can create Makefiles appropriate
to your platform based on <indexterm><primary>Files and file types</primary><secondary>.pro</secondary></indexterm>
<filename>.pro</> project files. This
section describes the dependencies involved in building a Qt application
and gives a couple of simple example Makefiles. This section assumes
that you have a good understanding of Makefiles.
</para>
<para id="ajbl">
<indexterm><primary>Macros</primary><secondary>Q_OBJECT</secondary></indexterm>

<indexterm><primary>Q_OBJECT</primary></indexterm>

<emphasis>Qt Designer</> produces <indexterm><primary>Files and file types</primary><secondary>.ui</secondary></indexterm>
<filename>.ui</> files which are used to generate
<indexterm><primary>Files and file types</primary><secondary>.h</secondary></indexterm>
<filename>.h</> and <indexterm><primary>Files and file types</primary><secondary>.cpp</secondary></indexterm>
<filename>.cpp</> files for the
compiler to compile. The <indexterm><primary>Files and file types</primary><secondary>.ui</secondary></indexterm>
<filename>.ui</> files are processed by
<indexterm><primary>uic</primary></indexterm>
<command>uic</>. Classes which inherit from <indexterm><primary>QObject</primary></indexterm>
<classname>QObject</>,
e.g. those which use slots and signals, require an additional
<indexterm><primary>Files and file types</primary><secondary>.cpp</secondary></indexterm>
<filename>.cpp</> file to be generated. These files are
generated by the <indexterm><primary>moc</primary></indexterm>
<command>moc</> and are named
'<emphasis>moc_</emphasis>file.cpp' where the original
<indexterm><primary>Files and file types</primary><secondary>.cpp</secondary></indexterm>
<filename>.cpp</> file is called 'file.cpp'. If your
<indexterm><primary>Files and file types</primary><secondary>.cpp</secondary></indexterm>
<filename>.cpp</> file contains the <literal>Q_OBJECT</literal>
macro an additional file 'file.moc' should be generated which must be
<literal>#include</literal>d in the <indexterm><primary>Files and file types</primary><secondary>.cpp</secondary></indexterm>
<filename>.cpp</>, normally
at the end. This requires an extra
dependency being created.
</para>
<para id="ajcb">
Processing <indexterm><primary>Files and file types</primary><secondary>.ui</secondary></indexterm>
<filename>.ui</> files with <indexterm><primary>uic</primary></indexterm>
<command>uic</> is done
<emphasis>twice</emphasis>:
<programlisting>
uic myform.ui -o myform.h
uic myform.ui -i myform.h -o myform.cpp
</programlisting>
The first execution creates the header file, the second creates the
<indexterm><primary>Files and file types</primary><secondary>.cpp</secondary></indexterm>
<filename>.cpp</> file. If you wish to subclass a form you can
use <indexterm><primary>uic</primary></indexterm>
<command>uic</> to generate subclass skeletons:
<programlisting>
uic formbase.ui -o formbase.h
uic formbase.ui -i formbase.h -o formbase.cpp
uic -subdecl Form formbase.h formbase.ui -o form.h
uic -subimpl Form formbase.h formbase.ui -o form.cpp
</programlisting>
First we generate the header and implementation file for our base class.
Then we generate the header and implementation skeletons for our subclass.
Note that the use of <indexterm><primary>uic</primary></indexterm>
<command>uic</> to generate skeletons is not something
that would be done in a Makefile, we mention it here because it can be
useful for command line users.
</para>
<para id="ajcx">
For implementation files that contain classes which inherit from
<indexterm><primary>QObject</primary></indexterm>
<classname>QObject</> we must create moc files:
<programlisting>
moc myform.h -o moc_myform.cpp
</programlisting>
</para>
<para id="ajde">
We'll look at a simple Makefile to see the dependencies in practice.
<programlisting>
myapp: moc_myform.o myform.o main.o
        g++ -lqt -o myapp moc_myform.o myform.o main.o

main.o: main.cpp
        g++ -o main.o main.cpp

moc_myform.o: moc_myform.cpp
        g++ -o moc_myform.o moc_myform.cpp

moc_myform.cpp: myform.h
        moc myform.h -o moc_myform.cpp

myform.o: myform.cpp
        g++ -o myform.o myform.cpp

myform.cpp: myform.h myform.ui
        uic myform.ui -i myform.h -o myform.cpp

myform.h: myform.ui
        uic myform.ui -o myform.h
</programlisting>
Note that you may need to include the full path to the commands in your
Makefile, and under Windows the filenames are <indexterm><primary>Files and file types</primary><secondary>moc.exe</secondary></indexterm>
<filename>moc.exe</> and <indexterm><primary>Files and file types</primary><secondary>uic.exe</secondary></indexterm>
<filename>uic.exe</>.
</para>
<para id="ajef">
In Unix/Linux environments the <indexterm><primary>make</primary></indexterm>
<command>make</> command may be able to
do more for us, so we should be able to use a simpler Makefile like
this:
<programlisting>
myapp: moc_myform.o myform.o main.o
        g++ -lq -o $@ $^

%.o: %.cpp
        g++ -o $^ $@

moc_%.cpp: %.h
        moc $^ -o $@

myform.cpp: myform.h myform.ui
        uic myform.ui -i myform.h -o myform.cpp

myform.h: myform.ui
        uic myform.ui -o myform.h
</programlisting>
To see more sophisticated Makefiles simply generate them using
<indexterm><primary>qmake</primary></indexterm>
<command>qmake</> on any of your Qt projects or any of the examples supplied
with Qt.
</para>
</sect2>

</sect1>

<sect1 id="importingforeignfileformats">
<title>Importing Foreign File Formats </title>

<para id="ajfk">
<indexterm><primary>Foreign File Formats</primary></indexterm>

To import a file in a supported foreign file format click 
<indexterm><primary>Menu Options</primary><secondary>File|Open</secondary></indexterm>
<guimenuitem>File|Open</>, then click the File Type combobox to choose the file
type you wish to load. Click the required file and <emphasis>Qt Designer</> will convert and
load the file.
</para>

<para id="ajfr">
The filters that <emphasis>Qt Designer</> uses to read foreign file formats are 'works in
progress'. You may have different filters available in your version of
<emphasis>Qt Designer</> than those described here. The easiest way to see which filters are
available is to invoke the file open dialog; all your filters are listed
in the File Type combobox. 
</para>

<sect2 id="importingqtarchitectfiles">
<title>Importing Qt Architect Files </title>

<para id="ajgc">
<indexterm><primary>Foreign File Formats</primary><secondary>Qt Architect</secondary></indexterm>

<indexterm><primary>Qt Architect</primary></indexterm>

<ulink url="http://qtarch.sourceforge.net/">Qt Architect</>
is a free GUI builder for Qt written by Jeff Harris and Klaus Ebner. The
<indexterm><primary>Files and file types</primary><secondary>.dlg</secondary></indexterm>
<filename>.dlg</> extension is associated with Qt Architect dialog files.
</para>
<para id="ajgh">
<emphasis>Qt Designer</> can read files generated by Qt Architect version 2.1 and
above. When given a <indexterm><primary>Files and file types</primary><secondary>.dlg</secondary></indexterm>
<filename>.dlg</> file from a previous version of Qt
Architect, <emphasis>Qt Designer</> tells you how to convert it to the file format
of version 2.1. (The conversion procedure varies depending on the
version of the <indexterm><primary>Files and file types</primary><secondary>.dlg</secondary></indexterm>
<filename>.dlg</> file.)
</para>
<para id="ajgo">
The import filter does a good job of importing <indexterm><primary>Files and file types</primary><secondary>.dlg</secondary></indexterm>
<filename>.dlg</> files; the
result is almost identical to what you get in Qt Architect. However, 
the C++ code that uses the dialogs will probably need some adaptation.
</para>
<para id="ajgt">
There are a few drawbacks to converting Qt Architect files to <emphasis>Qt Designer</>'s
format due to differences between the two tools; these are listed below:
<itemizedlist>
    <listitem>
    <para id="ajgy">
    Layout spacing and margins
    </para>
    <para id="ajhb">
    If the <indexterm><primary>Files and file types</primary><secondary>.dlg</secondary></indexterm>
<filename>.dlg</> file layouts use the Qt Architect defaults for
    layout spacing and margins, <emphasis>Qt Designer</> will override these with
    its standard defaults. You can change the "layoutSpacing" and
    "layoutMargin" properties manually afterwards if necessary.
    </para>
    </listitem>
    <listitem>
    <para id="ajhk">
    Layout stretches and spacings
    </para>
    <para id="ajhn">
    Qt Architect gives access to more features of Qt's layout
    system than <emphasis>Qt Designer</>, namely stretches and spacings. Qt
    Designer will attempt to cope with <indexterm><primary>Files and file types</primary><secondary>.dlg</secondary></indexterm>
<filename>.dlg</> files that use these
    features, but sometimes the resizing will not be what you want. 
    The solution typically involves setting the
    "sizePolicy" properties of some widgets and inserting or
    deleting spacers.
    </para>
    </listitem>
    <listitem>
    <para id="ajil">
    Mixing managed and unmanaged widgets
    </para>
    <para id="ajio">
    Qt Architect allows a widget to have some child widgets managed by a
    layout and other child widgets with fixed positions. When presented
    with a <indexterm><primary>Files and file types</primary><secondary>.dlg</secondary></indexterm>
<filename>.dlg</> file that uses this facility, <emphasis>Qt Designer</> will silently put
    the fixed position widgets into the layout.
    </para>
    </listitem>
    <listitem>
    <para id="ajiw">
    Pixmaps
    </para>
    <para id="ajiz">
    <emphasis>Qt Designer</> ignores pixmaps specified in <indexterm><primary>Files and file types</primary><secondary>.dlg</secondary></indexterm>
<filename>.dlg</> files. These
    have to be restored manually in <emphasis>Qt Designer</>.
    </para>
    </listitem>
</itemizedlist>
</para>
</sect2>


<sect2 id="importinggladefiles">
<title>Importing Glade Files </title>

<para id="ajjl">
<indexterm><primary>Foreign File Formats</primary><secondary>Glade</secondary></indexterm>

<indexterm><primary>Glade</primary></indexterm>

<ulink url="http://glade.pn.org/">Glade</> is a free GUI builder for
GTK+ and GNOME written by Damon Chaplin. The <indexterm><primary>Files and file types</primary><secondary>.glade</secondary></indexterm>
<filename>.glade</> extension is
associated with Glade files.
</para>
<para id="ajjq">
<emphasis>Qt Designer</> has been tested with Glade files up to version 0.6.0 and
might work with later versions as well.
</para>
<para id="ajju">
Although Glade does not target Qt, the layout system and the widget
set of GTK+ are similar to those of Qt, so the filter will retain
most of the information in the <indexterm><primary>Files and file types</primary><secondary>.glade</secondary></indexterm>
<filename>.glade</> file.
</para>
<para id="ajjz">
There are some considerations regarding the conversion of Glade files,
as listed below:
<itemizedlist>
    <listitem>
    <para id="ajke">
    Ampersands (&amp;) in labels
    </para>
    <para id="ajkh">
    Qt displays an ampersand when a <indexterm><primary>QLabel</primary></indexterm>
<classname>QLabel</> has no buddy.
    (A buddy is a widget that accepts focus on behalf of a <indexterm><primary>QLabel</primary></indexterm>
<classname>QLabel</>.)
    Glade allows GtkLabel widgets with an (underlined)
    accelerator key but with no buddy. This is an error since
    users expect underlined characters to be accelerators. In
    this situation, Qt displays the ampersand itself instead of
    underlining the accelerator key. You should go over these <indexterm><primary>QLabel</primary></indexterm>
<classname>QLabel</>
    widgets and set their "<indexterm><primary>Properties</primary><secondary>buddy</secondary></indexterm>
buddy" property.
    </para>
    </listitem>
    <listitem>
    <para id="ajkt">
    Layout placeholders
    </para>
    <para id="ajkw">
    GTK allows a layout position to be occupied by a placeholder. <emphasis>Qt Designer</>
    converts those placeholders into <indexterm><primary>QLabel</primary></indexterm>
<classname>QLabel</>s whose text is "?"
    in red, so that you can find them and fix them manually.
    </para>
    </listitem>
    <listitem>
    <para id="ajld">
    GTK+ or GNOME widget with no Qt equivalent
    </para>
    <para id="ajlg">
    Qt has equivalents for most GTK+ widgets, but Glade also
    supports GNOME, whose goal is to provide a complete desktop
    environment. Because Qt's scope is narrower, when <emphasis>Qt Designer</>
    encounters a widget it cannot convert, it replaces it with a
    label that indicates the problem. For example, a
    GnomePaperSelector will be replaced by a <indexterm><primary>QLabel</primary></indexterm>
<classname>QLabel</> whose text is
    "GnomePaperSelector?" in red. If you are porting to KDE, you
    might want to use the corresponding KDE widget.
    </para>
    <para id="ajlq">
    Other GTK+/GNOME widgets are only supported in certain
    contexts. For example, the GnomeDruid can be embedded in
    another widget, whereas the corresponding <indexterm><primary>QWizard</primary></indexterm>
<classname>QWizard</> class
    cannot.
    </para>
    </listitem>
    <listitem>
    <para id="ajly">
    Message boxes and other high-level dialogs
    </para>
    <para id="ajmb">
    Glade supports editing of GnomeMessageBox, GtkFileSelection,
    GtkFontSelectionDialog and others. This is trivially achieved in
    Qt by means of a <indexterm><primary>QMessageBox</primary></indexterm>
<classname>QMessageBox</> dialog, a <indexterm><primary>QFileDialog</primary></indexterm>
<classname>QFileDialog</>, a
    <indexterm><primary>QFontDialog</primary></indexterm>
<classname>QFontDialog</>, etc., in C++ code.
    </para>
    </listitem>
    <listitem>
    <para id="ajmj">
    Stand-alone popup menus
    </para>
    <para id="ajmm">
    <emphasis>Qt Designer</> only supports popup menus inside a <indexterm><primary>QMainWindow</primary></indexterm>
<classname>QMainWindow</>. If you
    need a stand-alone popup menu (presumably a context menu),
    you can easily write code that does this using <indexterm><primary>QPopupMenu</primary></indexterm>
<classname>QPopupMenu</>.
    </para>
    </listitem>
    <listitem>
    <para id="ajmt">
    Size policy parameters
    </para>
    <para id="ajmw">
    Glade provides size policies in the "Place" tab of the property
    editor. <emphasis>Qt Designer</> does not attempt to make use of the padding, expand,
    shrink and fill information, as the Qt defaults are usually good
    enough. In a few cases, you might have to set the "<indexterm><primary>Properties</primary><secondary>sizePolicy</secondary></indexterm>
sizePolicy"
    property manually to obtain the effect you want.
    </para>
    </listitem>
    <listitem>
    <para id="ajnf">
    GNOME standard icons
    </para>
    <para id="ajni">
    GNOME provides a large set of standard icons. <emphasis>Qt Designer</> will
    ignore references to these. If you are porting to KDE, you
    might want to manually set the standard KDE icons.
    </para>
    </listitem>
    <listitem>
    <para id="ajnp">
    Packer layout
    </para>
    <para id="ajns">
    GTK+ provides a class called GtkPacker that provides for exotic
    layouts; Qt provides no <indexterm><primary>QPackerLayout</primary></indexterm>
<classname>QPackerLayout</> and never will. <emphasis>Qt Designer</>
    will treat packer layouts as if they were vertical layouts and
    you will probably have to change them to whatever combination of
    layouts that produces the right effect.
    </para>
    </listitem>
    <listitem>
    <para id="ajob">
    Incorrectly-justified text after conversion
    </para>
    <para id="ajoe">
    The "<indexterm><primary>Properties</primary><secondary>hAlign</secondary></indexterm>
hAlign" property is sometimes set wrongly, in which case you
    have to change it manually. It is caused by a quirk in Glade.
    </para>
    </itemizedlist>
</sect2>

</sect1>
</chapter>
